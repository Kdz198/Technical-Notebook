<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° Stored Procedure & Spring Boot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #1A1A1A;
            color: #E0E0E0;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
        }
        .sidebar-link {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        .sidebar-link.active, .sidebar-link:hover {
            background-color: #2A2A2A;
            color: #F28C38;
            border-left-color: #F28C38;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .card {
            background-color: #2A2A2A;
            border: 1px solid #3A3A3A;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.15), 0 4px 6px -4px rgb(0 0 0 / 0.15);
        }
        .code-block {
            background-color: #1E1E1E;
            color: #F8F8F2;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
        }
        .code-block .keyword { color: #FF79C6; }
        .code-block .type { color: #8BE9FD; }
        .code-block .string { color: #F1FA8C; }
        .code-block .comment { color: #6272A4; }
        .code-block .function { color: #50FA7B; }
        .code-block .variable { color: #BD93F9; }
        .tab.active {
            border-bottom-color: #F28C38;
            color: #F28C38;
            font-weight: 600;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            visibility: hidden;
            transition: max-height 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }
        .accordion-content.open {
            max-height: 500px; /* Adjust as needed */
            visibility: visible;
        }
        .accordion-item {
            background-color: #2A2A2A;
            border: 1px solid #3A3A3A;
        }
    </style>
</head>
<body class="antialiased">

<div class="flex flex-col md:flex-row min-h-screen">
    <aside class="sidebar w-full md:w-64 bg-[#1E1E1E] border-r border-[#3A3A3A] flex-shrink-0">
        <div class="p-6">
            <h1 class="text-xl font-bold text-[#F28C38]">Stored Procedure</h1>
            <p class="text-sm text-gray-400">v√† Spring Boot</p>
        </div>
        <nav class="mt-2">
            <a href="#overview" class="sidebar-link active flex items-center px-6 py-3 text-gray-300">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                T·ªïng Quan
            </a>
            <a href="#architecture" class="sidebar-link flex items-center px-6 py-3 text-gray-300">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                Ki·∫øn tr√∫c & C√∫ ph√°p
            </a>
            <a href="#integration" class="sidebar-link flex items-center px-6 py-3 text-gray-300">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                T√≠ch h·ª£p Spring Boot
            </a>
            <a href="#optimization" class="sidebar-link flex items-center px-6 py-3 text-gray-300">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                T·ªëi ∆∞u & Th·ª±c h√†nh
            </a>
            <a href="#casestudy" class="sidebar-link flex items-center px-6 py-3 text-gray-300">
                <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                Case Study
            </a>
        </nav>
    </aside>

    <main class="flex-1 p-6 sm:p-8 md:p-10 md:ml-64">
        <div id="overview" class="content-section active">
            <h2 class="text-3xl font-bold text-gray-100 mb-4">Stored Procedure l√† g√¨?</h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                Stored Procedure (SP) l√† m·ªôt t·∫≠p h·ª£p c√°c c√¢u l·ªánh SQL ƒë∆∞·ª£c ƒë·∫∑t t√™n v√† l∆∞u tr·ªØ s·∫µn tr√™n m√°y ch·ªß c∆° s·ªü d·ªØ li·ªáu. N√≥ ho·∫°t ƒë·ªông nh∆∞ m·ªôt h√†m c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng, gi√∫p ƒë√≥ng g√≥i logic nghi·ªáp v·ª•, tƒÉng c∆∞·ªùng hi·ªáu nƒÉng v√† c·∫£i thi·ªán b·∫£o m·∫≠t b·∫±ng c√°ch th·ª±c thi c√°c t√°c v·ª• ph·ª©c t·∫°p ngay t·∫°i n∆°i d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ.
            </p>

            <h3 class="text-2xl font-bold text-gray-100 mb-6">C√°c V·∫•n ƒê·ªÅ C·ªët L√µi ƒê∆∞·ª£c Gi·∫£i Quy·∫øt</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-full bg-orange-900 text-orange-400 mr-4">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-100">TƒÉng Hi·ªáu NƒÉng</h4>
                    </div>
                    <p class="text-gray-400">SP ƒë∆∞·ª£c bi√™n d·ªãch s·∫µn v√† l∆∞u v√†o cache, gi√∫p gi·∫£m th·ªùi gian th·ª±c thi truy v·∫•n v√† gi·∫£m t·∫£i l∆∞u l∆∞·ª£ng m·∫°ng ƒë√°ng k·ªÉ.</p>
                </div>
                <div class="card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-full bg-green-900 text-green-400 mr-4">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-100">C·∫£i Thi·ªán B·∫£o M·∫≠t</h4>
                    </div>
                    <p class="text-gray-400">Gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p tr·ª±c ti·∫øp v√†o b·∫£ng, ch·ªâ cho ph√©p th·ª±c thi SP, gi√∫p ngƒÉn ch·∫∑n SQL Injection v√† ki·ªÉm so√°t d·ªØ li·ªáu.</p>
                </div>
                <div class="card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-full bg-blue-900 text-blue-400 mr-4">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-100">Logic Nh·∫•t Qu√°n</h4>
                    </div>
                    <p class="text-gray-400">T·∫≠p trung logic nghi·ªáp v·ª• t·∫°i m·ªôt n∆°i, ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n v√† d·ªÖ b·∫£o tr√¨ tr√™n c√°c m√¥i tr∆∞·ªùng v√† ·ª©ng d·ª•ng kh√°c nhau.</p>
                </div>
            </div>
        </div>

        <div id="architecture" class="content-section">
            <h2 class="text-3xl font-bold text-gray-100 mb-4">Ki·∫øn tr√∫c & C√∫ ph√°p</h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                Hi·ªÉu c√°ch Stored Procedure ƒë∆∞·ª£c bi√™n d·ªãch, l∆∞u tr·ªØ v√† th·ª±c thi l√† ch√¨a kh√≥a ƒë·ªÉ t·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa ch√∫ng. C√∫ ph√°p c√≥ th·ªÉ kh√°c nhau gi·ªØa c√°c h·ªá qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu, nh∆∞ng c√°c th√†nh ph·∫ßn c·ªët l√µi v·∫´n t∆∞∆°ng t·ª±.
            </p>

            <h3 class="text-2xl font-bold text-gray-100 mb-6">V√≤ng ƒê·ªùi Th·ª±c Thi</h3>
            <div class="bg-[#2A2A2A] p-6 rounded-lg border border-[#3A3A3A]">
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4 text-center">
                    <div class="flex-1">
                        <div class="p-3 bg-gray-700 rounded-full inline-block text-gray-300">1</div>
                        <p class="mt-2 font-semibold text-gray-100">T·∫°o SP</p>
                        <p class="text-sm text-gray-400">M√£ ngu·ªìn ƒë∆∞·ª£c l∆∞u trong DB.</p>
                    </div>
                    <div class="text-gray-500 text-2xl font-light">‚Üí</div>
                    <div class="flex-1">
                        <div class="p-3 bg-blue-900 rounded-full inline-block text-blue-400">2</div>
                        <p class="mt-2 font-semibold text-gray-100">Th·ª±c thi l·∫ßn ƒë·∫ßu</p>
                        <p class="text-sm text-gray-400">Bi√™n d·ªãch & t·∫°o K·∫ø ho·∫°ch th·ª±c thi.</p>
                    </div>
                    <div class="text-gray-500 text-2xl font-light">‚Üí</div>
                    <div class="flex-1">
                        <div class="p-3 bg-purple-900 rounded-full inline-block text-purple-400">3</div>
                        <p class="mt-2 font-semibold text-gray-100">L∆∞u v√†o Cache</p>
                        <p class="text-sm text-gray-400">K·∫ø ho·∫°ch ƒë∆∞·ª£c l∆∞u trong Plan Cache.</p>
                    </div>
                    <div class="text-gray-500 text-2xl font-light">‚Üí</div>
                    <div class="flex-1">
                        <div class="p-3 bg-green-900 rounded-full inline-block text-green-400">4</div>
                        <p class="mt-2 font-semibold text-gray-100">Th·ª±c thi l·∫ßn sau</p>
                        <p class="text-sm text-gray-400">T√°i s·ª≠ d·ª•ng k·∫ø ho·∫°ch t·ª´ cache.</p>
                    </div>
                </div>
            </div>

            <h3 class="text-2xl font-bold text-gray-100 mt-10 mb-6">So S√°nh C√∫ Ph√°p</h3>
            <div class="bg-[#2A2A2A] rounded-lg border border-[#3A3A3A]">
                <div class="p-4 border-b border-[#3A3A3A]">
                    <p class="font-semibold text-gray-100">V√≠ d·ª•: T√≠nh t·ªïng doanh thu theo tr·∫°ng th√°i ƒë∆°n h√†ng.</p>
                </div>
                <div class="flex border-b border-[#3A3A3A]">
                    <button class="syntax-tab tab active p-4 flex-1 text-center text-gray-300" data-target="mssql-syntax">MSSQL (T-SQL)</button>
                    <button class="syntax-tab tab p-4 flex-1 text-center text-gray-300" data-target="pgsql-syntax">PostgreSQL (PL/pgSQL)</button>
                </div>
                <div id="mssql-syntax" class="syntax-content p-4">
<pre class="code-block"><span class="keyword">CREATE PROCEDURE</span> <span class="function">GetTotalRevenueByStatus</span>
    <span class="variable">@OrderStatus</span> <span class="type">VARCHAR</span>(50),
    <span class="variable">@TotalRevenue</span> <span class="type">DECIMAL</span>(10,2) <span class="keyword">OUTPUT</span>
<span class="keyword">AS</span>
<span class="keyword">BEGIN</span>
    <span class="keyword">SELECT</span> <span class="variable">@TotalRevenue</span> = <span class="function">SUM</span>(TotalAmount)
    <span class="keyword">FROM</span> Orders
    <span class="keyword">WHERE</span> Status = <span class="variable">@OrderStatus</span>;
<span class="keyword">END</span>;</pre>
                </div>
                <div id="pgsql-syntax" class="syntax-content p-4 hidden">
<pre class="code-block"><span class="keyword">CREATE PROCEDURE</span> <span class="function">GetTotalRevenueByStatus</span>(
    <span class="keyword">IN</span> <span class="variable">order_status</span> <span class="type">VARCHAR</span>(50),
    <span class="keyword">OUT</span> <span class="variable">total_revenue</span> <span class="type">DECIMAL</span>(10,2)
)
<span class="keyword">LANGUAGE</span> plpgsql
<span class="keyword">AS</span> $$
<span class="keyword">BEGIN</span>
    <span class="keyword">SELECT</span> <span class="function">SUM</span>(totalamount) <span class="keyword">INTO</span> total_revenue
    <span class="keyword">FROM</span> orders
    <span class="keyword">WHERE</span> status = order_status;
<span class="keyword">END</span>;
$$;</pre>
                </div>
            </div>
        </div>

        <div id="integration" class="content-section">
            <h2 class="text-3xl font-bold text-gray-100 mb-4">T√≠ch h·ª£p v·ªõi Spring Boot</h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                Spring Boot cung c·∫•p nhi·ªÅu c∆° ch·∫ø m·∫°nh m·∫Ω ƒë·ªÉ g·ªçi Stored Procedure, cho ph√©p k·∫øt h·ª£p s·ª± ti·ªán l·ª£i c·ªßa JPA v·ªõi hi·ªáu nƒÉng v√† b·∫£o m·∫≠t c·ªßa logic ph√≠a database.
            </p>

            <h3 class="text-2xl font-bold text-gray-100 mb-6">C√°c Ph∆∞∆°ng Ph√°p G·ªçi SP</h3>
            <div class="bg-[#2A2A2A] rounded-lg border border-[#3A3A3A]">
                <div class="flex border-b border-[#3A3A3A]">
                    <button class="integration-tab tab active p-4 flex-1 text-center text-gray-300" data-target="native-query">@Query (nativeQuery)</button>
                    <button class="integration-tab tab p-4 flex-1 text-center text-gray-300" data-target="procedure-annotation">@Procedure</button>
                    <button class="integration-tab tab p-4 flex-1 text-center text-gray-300" data-target="jdbc-template">JdbcTemplate</button>
                </div>
                <div id="native-query" class="integration-content p-4">
                    <p class="mb-4 text-gray-400">S·ª≠ d·ª•ng truy v·∫•n SQL g·ªëc, linh ho·∫°t nh·∫•t ƒë·ªÉ th·ª±c thi b·∫•t k·ª≥ l·ªánh n√†o, bao g·ªìm c·∫£ `EXEC` ho·∫∑c `CALL`.</p>
                    <pre class="code-block"><span class="comment">// Trong OrderRepository.java</span>
<span class="keyword">@Query</span>(value = <span class="string">"EXEC CreateOrder :customerId, :productId, :quantity, :total"</span>, nativeQuery = <span class="keyword">true</span>)
<span class="type">void</span> <span class="function">createOrderSP</span>(
    <span class="keyword">@Param</span>(<span class="string">"customerId"</span>) <span class="type">int</span> customerId,
    <span class="keyword">@Param</span>(<span class="string">"productId"</span>) <span class="type">int</span> productId,
    <span class="keyword">@Param</span>(<span class="string">"quantity"</span>) <span class="type">int</span> quantity,
    <span class="keyword">@Param</span>(<span class="string">"total"</span>) <span class="type">BigDecimal</span> total
);</pre>
                </div>
                <div id="procedure-annotation" class="integration-content p-4 hidden">
                    <p class="mb-4 text-gray-400">√Ånh x·∫° tr·ª±c ti·∫øp m·ªôt ph∆∞∆°ng th·ª©c trong repository t·ªõi m·ªôt SP, gi√∫p m√£ ngu·ªìn g·ªçn g√†ng v√† t√≠ch h·ª£p ch·∫∑t ch·∫Ω v·ªõi Spring Data JPA.</p>
                    <pre class="code-block"><span class="comment">// Trong ProductRepository.java</span>
<span class="keyword">@Procedure</span>(procedureName = <span class="string">"GetProductCountByCategory"</span>)
<span class="type">Integer</span> <span class="function">getProductCountByCategory</span>(<span class="keyword">@Param</span>(<span class="string">"categoryName"</span>) <span class="type">String</span> categoryName);</pre>
                </div>
                <div id="jdbc-template" class="integration-content p-4 hidden">
                    <p class="mb-4 text-gray-400">Cung c·∫•p m·ª©c ƒë·ªô ki·ªÉm so√°t cao nh·∫•t, ph√π h·ª£p cho c√°c k·ªãch b·∫£n ph·ª©c t·∫°p c·∫ßn x·ª≠ l√Ω tham s·ªë IN/OUT v√† k·∫øt qu·∫£ tr·∫£ v·ªÅ ƒëa d·∫°ng.</p>
                    <pre class="code-block"><span class="comment">// Trong m·ªôt Service</span>
SimpleJdbcCall jdbcCall = <span class="keyword">new</span> <span class="function">SimpleJdbcCall</span>(dataSource)
    .withProcedureName(<span class="string">"GetEmployeeById"</span>);

SqlParameterSource in = <span class="keyword">new</span> <span class="function">MapSqlParameterSource</span>()
    .addValue(<span class="string">"empId"</span>, employeeId);

Map&lt;<span class="type">String</span>, <span class="type">Object</span>&gt; out = jdbcCall.execute(in);
<span class="type">String</span> name = (<span class="type">String</span>) out.get(<span class="string">"empName"</span>);</pre>
                </div>
            </div>

            <h3 class="text-2xl font-bold text-gray-100 mt-10 mb-6">So S√°nh: Stored Procedure vs. JPA</h3>
            <p class="text-center text-gray-400 mb-4">L·ª±a ch·ªçn gi·ªØa hai ph∆∞∆°ng ph√°p l√† m·ªôt quy·∫øt ƒë·ªãnh ki·∫øn tr√∫c quan tr·ªçng, ph·ª• thu·ªôc v√†o y√™u c·∫ßu c·ª• th·ªÉ c·ªßa t√°c v·ª•.</p>
            <div class="chart-container">
                <canvas id="jpaVsSpChart"></canvas>
            </div>
        </div>

        <div id="optimization" class="content-section">
            <h2 class="text-3xl font-bold text-gray-100 mb-4">T·ªëi ∆∞u & Th·ª±c h√†nh t·ªët nh·∫•t</h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                √Åp d·ª•ng c√°c th·ª±c h√†nh t·ªët nh·∫•t v·ªÅ b·∫£o m·∫≠t, hi·ªáu nƒÉng v√† ph√°t tri·ªÉn l√† y·∫øu t·ªë then ch·ªët ƒë·ªÉ x√¢y d·ª±ng c√°c Stored Procedure an to√†n, hi·ªáu qu·∫£ v√† d·ªÖ b·∫£o tr√¨ trong c√°c h·ªá th·ªëng doanh nghi·ªáp.
            </p>

            <div class="space-y-4">
                <div class="accordion-item bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg">
                    <button class="accordion-header w-full text-left p-4 font-semibold text-lg flex justify-between items-center text-gray-100">
                        <span>üîí Security Best Practices</span>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </button>
                    <div class="accordion-content px-4 pb-4">
                        <ul class="list-disc list-inside space-y-2 text-gray-400">
                            <li><strong>Nguy√™n t·∫Øc ƒë·∫∑c quy·ªÅn t·ªëi thi·ªÉu (PoLP):</strong> Ch·ªâ c·∫•p quy·ªÅn `EXECUTE` tr√™n SP, kh√¥ng c·∫•p quy·ªÅn truy c·∫≠p tr·ª±c ti·∫øp v√†o b·∫£ng.</li>
                            <li><strong>Truy v·∫•n tham s·ªë h√≥a:</strong> Lu√¥n s·ª≠ d·ª•ng tham s·ªë ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu, tr√°nh n·ªëi chu·ªói SQL ƒë·ªông ƒë·ªÉ ch·ªëng SQL Injection.</li>
                            <li><strong>M√£ h√≥a d·ªØ li·ªáu:</strong> B·∫£o v·ªá d·ªØ li·ªáu nh·∫°y c·∫£m b·∫±ng c√°c t√≠nh nƒÉng m√£ h√≥a c·ªßa database (TDE, Always Encrypted).</li>
                            <li><strong>Ghi log ki·ªÉm to√°n:</strong> Ghi l·∫°i c√°c thao t√°c quan tr·ªçng ƒë∆∞·ª£c th·ª±c hi·ªán b·ªüi SP ƒë·ªÉ theo d√µi v√† ƒëi·ªÅu tra.</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg">
                    <button class="accordion-header w-full text-left p-4 font-semibold text-lg flex justify-between items-center text-gray-100">
                        <span>‚ö° Performance Optimization</span>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </button>
                    <div class="accordion-content px-4 pb-4">
                        <ul class="list-disc list-inside space-y-2 text-gray-400">
                            <li><strong>T·ªëi ∆∞u h√≥a Index:</strong> ƒê·∫£m b·∫£o c√°c b·∫£ng c√≥ index ph√π h·ª£p tr√™n c√°c c·ªôt ƒë∆∞·ª£c d√πng trong `WHERE`, `JOIN`, `ORDER BY`.</li>
                            <li><strong>Tr√°nh Logic Ph·ª©c T·∫°p:</strong> Gi·ªØ SP ƒë∆°n gi·∫£n, ∆∞u ti√™n c√°c thao t√°c d·ª±a tr√™n t·∫≠p h·ª£p (set-based) thay v√¨ cursors ho·∫∑c v√≤ng l·∫∑p.</li>
                            <li><strong>X·ª≠ l√Ω theo l√¥ (Batch Processing):</strong> Chia nh·ªè c√°c thao t√°c DML l·ªõn th√†nh c√°c l√¥ nh·ªè h∆°n ƒë·ªÉ gi·∫£m kh√≥a (locking) v√† t·∫£i cho transaction log.</li>
                            <li><strong>S·ª≠ d·ª•ng `SET NOCOUNT ON` (MSSQL):</strong> NgƒÉn tr·∫£ v·ªÅ th√¥ng b√°o "X rows affected" ƒë·ªÉ gi·∫£m l∆∞u l∆∞·ª£ng m·∫°ng.</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg">
                    <button class="accordion-header w-full text-left p-4 font-semibold text-lg flex justify-between items-center text-gray-100">
                        <span>üõ†Ô∏è Development Best Practices</span>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </button>
                    <div class="accordion-content px-4 pb-4">
                        <ul class="list-disc list-inside space-y-2 text-gray-400">
                            <li><strong>Qu·∫£n l√Ω phi√™n b·∫£n (Version Control):</strong> L∆∞u tr·ªØ m√£ ngu·ªìn SP trong Git v√† s·ª≠ d·ª•ng c√°c c√¥ng c·ª• di tr√∫ (migration tools) ƒë·ªÉ tri·ªÉn khai.</li>
                            <li><strong>T√†i li·ªáu h√≥a:</strong> Vi·∫øt t√†i li·ªáu r√µ r√†ng v·ªÅ m·ª•c ƒë√≠ch, tham s·ªë v√† logic c·ªßa m·ªói SP.</li>
                            <li><strong>Ki·ªÉm th·ª≠ (Testing):</strong> Vi·∫øt unit test v√† integration test ƒë·ªÉ x√°c minh SP ho·∫°t ƒë·ªông ƒë√∫ng nh∆∞ mong ƒë·ª£i.</li>
                            <li><strong>T√≠nh nh·∫•t qu√°n:</strong> Tu√¢n th·ªß quy ∆∞·ªõc ƒë·∫∑t t√™n nh·∫•t qu√°n v√† ƒë·∫£m b·∫£o SP ho·∫°t ƒë·ªông gi·ªëng nhau tr√™n c√°c m√¥i tr∆∞·ªùng.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="casestudy" class="content-section">
            <h2 class="text-3xl font-bold text-gray-100 mb-4">Case Study: N·ªÅn t·∫£ng E-commerce</h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                Minh h·ªça c√°ch Stored Procedure ƒë∆∞·ª£c √°p d·ª•ng chi·∫øn l∆∞·ª£c trong ki·∫øn tr√∫c microservices ƒë·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ v·ªÅ hi·ªáu nƒÉng v√† t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu trong m·ªôt h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠.
            </p>

            <h3 class="text-2xl font-bold text-gray-100 mb-6">Ki·∫øn tr√∫c Microservices</h3>
            <div class="bg-[#2A2A2A] p-6 rounded-lg border border-[#3A3A3A]">
                <div class="flex flex-wrap items-center justify-center gap-4 text-center">
                    <div class="p-4 border rounded-lg w-40 border-[#3A3A3A] bg-[#2A2A2A]">
                        <p class="font-bold text-gray-100">User Service</p>
                        <p class="text-sm text-gray-400">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</p>
                    </div>
                    <div class="text-gray-500">‚Üî</div>
                    <div class="p-4 border-2 border-orange-600 rounded-lg bg-orange-950 w-48 shadow-lg">
                        <p class="font-bold text-orange-400">Order Service</p>
                        <p class="text-sm text-orange-500">SP: CreateOrder (Giao d·ªãch nguy√™n t·ª≠)</p>
                    </div>
                    <div class="text-gray-500">‚Üî</div>
                    <div class="p-4 border rounded-lg w-40 border-[#3A3A3A] bg-[#2A2A2A]">
                        <p class="font-bold text-gray-100">Payment Service</p>
                        <p class="text-sm text-gray-400">SP: T√≠nh ph√≠</p>
                    </div>
                    <div class="text-gray-500">‚Üî</div>
                    <div class="p-4 border-2 border-blue-600 rounded-lg bg-blue-950 w-48 shadow-lg">
                        <p class="font-bold text-blue-400">Reporting Service</p>
                        <p class="text-sm text-blue-500">SP: T·ªïng h·ª£p b√°o c√°o</p>
                    </div>
                </div>
                <div class="text-center mt-4 text-gray-400">Giao ti·∫øp b·∫•t ƒë·ªìng b·ªô qua <span class="font-semibold text-green-400">RabbitMQ</span></div>
            </div>

            <h3 class="text-2xl font-bold text-gray-100 mt-10 mb-6">V√≠ d·ª• SP then ch·ªët: `CreateOrder`</h3>
            <p class="mb-4 text-gray-400">SP n√†y ƒë·∫£m b·∫£o vi·ªác ki·ªÉm tra t·ªìn kho, t·∫°o ƒë∆°n h√†ng v√† c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng l√† m·ªôt giao d·ªãch nguy√™n t·ª≠, ngƒÉn ch·∫∑n t√¨nh tr·∫°ng b√°n qu√° s·ªë l∆∞·ª£ng h√†ng c√≥ s·∫µn (overselling).</p>
            <pre class="code-block"><span class="keyword">CREATE PROCEDURE</span> <span class="function">CreateOrder</span>
    <span class="variable">@CustomerId</span> <span class="type">INT</span>, <span class="variable">@ProductId</span> <span class="type">INT</span>, <span class="variable">@Quantity</span> <span class="type">INT</span>
<span class="keyword">AS</span>
<span class="keyword">BEGIN</span>
    <span class="keyword">BEGIN TRY</span>
        <span class="keyword">BEGIN TRANSACTION</span>;

        <span class="comment">-- 1. Ki·ªÉm tra t·ªìn kho</span>
        <span class="keyword">IF</span> (<span class="keyword">SELECT</span> quantity <span class="keyword">FROM</span> inventory <span class="keyword">WHERE</span> product_id = <span class="variable">@ProductId</span>) < <span class="variable">@Quantity</span>
            <span class="keyword">THROW</span> 50001, <span class="string">'Not enough inventory'</span>, 1;

        <span class="comment">-- 2. T·∫°o ƒë∆°n h√†ng</span>
        <span class="keyword">INSERT INTO</span> orders (customer_id, product_id, quantity)
        <span class="keyword">VALUES</span> (<span class="variable">@CustomerId</span>, <span class="variable">@ProductId</span>, <span class="variable">@Quantity</span>);

        <span class="comment">-- 3. C·∫≠p nh·∫≠t t·ªìn kho</span>
        <span class="keyword">UPDATE</span> inventory <span class="keyword">SET</span> quantity = quantity - <span class="variable">@Quantity</span>
        <span class="keyword">WHERE</span> product_id = <span class="variable">@ProductId</span>;

        <span class="keyword">COMMIT</span>;
    <span class="keyword">END TRY</span>
    <span class="keyword">BEGIN CATCH</span>
        <span class="keyword">ROLLBACK</span>;
        <span class="keyword">THROW</span>;
    <span class="keyword">END CATCH</span>;
<span class="keyword">END</span>;</pre>
        </div>
    </main>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const contentSections = document.querySelectorAll('.content-section');
        const syntaxTabs = document.querySelectorAll('.syntax-tab');
        const integrationTabs = document.querySelectorAll('.integration-tab');
        const accordionHeaders = document.querySelectorAll('.accordion-header');

        function navigateToSection(hash) {
            sidebarLinks.forEach(link => {
                link.classList.toggle('active', link.hash === hash);
            });
            contentSections.forEach(section => {
                section.classList.toggle('active', '#' + section.id === hash);
            });
        }

        sidebarLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const targetHash = this.hash;
                window.location.hash = targetHash;
                navigateToSection(targetHash);
            });
        });

        const initialHash = window.location.hash || '#overview';
        navigateToSection(initialHash);

        function handleTabClick(tabs, contentSelector) {
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    document.querySelectorAll(contentSelector).forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(this.dataset.target).classList.remove('hidden');
                });
            });
        }

        handleTabClick(syntaxTabs, '.syntax-content');
        handleTabClick(integrationTabs, '.integration-content');

        accordionHeaders.forEach(header => {
            const content = header.nextElementSibling;
            const icon = header.querySelector('span:last-child');

            // Initialize all accordions as closed
            content.style.maxHeight = '0';
            content.classList.remove('open');
            content.style.visibility = 'hidden';
            icon.style.transform = 'rotate(0deg)';

            header.addEventListener('click', () => {
                const isOpen = content.classList.contains('open');

                // Close all accordions
                document.querySelectorAll('.accordion-content').forEach(c => {
                    c.style.maxHeight = '0';
                    c.classList.remove('open');
                    c.style.visibility = 'hidden';
                });
                document.querySelectorAll('.accordion-header span:last-child').forEach(i => {
                    i.style.transform = 'rotate(0deg)';
                });

                // Toggle the clicked accordion
                if (!isOpen) {
                    content.classList.add('open');
                    content.style.maxHeight = content.scrollHeight + 'px';
                    content.style.visibility = 'visible';
                    icon.style.transform = 'rotate(180deg)';
                }
            });
        });

        const ctx = document.getElementById('jpaVsSpChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Hi·ªáu nƒÉng (T·∫£i cao)', 'B·∫£o m·∫≠t', 'T√≠nh di ƒë·ªông (Portability)', 'T·ªëc ƒë·ªô ph√°t tri·ªÉn', 'Kh·∫£ nƒÉng b·∫£o tr√¨', 'Qu·∫£n l√Ω Transaction'],
                    datasets: [{
                        label: 'Stored Procedure',
                        data: [9, 9, 3, 5, 6, 9],
                        backgroundColor: 'rgba(242, 140, 56, 0.2)',
                        borderColor: 'rgba(242, 140, 56, 1)',
                        pointBackgroundColor: 'rgba(242, 140, 56, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(242, 140, 56, 1)'
                    }, {
                        label: 'JPA / Application Logic',
                        data: [6, 7, 9, 9, 8, 6],
                        backgroundColor: 'rgba(100, 100, 100, 0.2)',
                        borderColor: 'rgba(100, 100, 100, 1)',
                        pointBackgroundColor: 'rgba(100, 100, 100, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(100, 100, 100, 1)'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                color: '#3A3A3A'
                            },
                            grid: {
                                color: '#3A3A3A'
                            },
                            pointLabels: {
                                font: {
                                    size: 12,
                                    family: "'Be Vietnam Pro', sans-serif"
                                },
                                color: '#E0E0E0'
                            },
                            ticks: {
                                backdropColor: 'rgba(26, 26, 26, 0.75)',
                                color: '#A0A0A0',
                                stepSize: 2
                            },
                            suggestedMin: 0,
                            suggestedMax: 10
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    family: "'Be Vietnam Pro', sans-serif"
                                },
                                color: '#E0E0E0'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.r !== null) {
                                        label += context.parsed.r + '/10';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
    });
</script>
</body>
</html>