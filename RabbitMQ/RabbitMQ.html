<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n T√≠ch K·ªπ Thu·∫≠t To√†n Di·ªán: RabbitMQ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #334155; /* slate-700 */
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active {
            border-bottom-color: #0ea5e9; /* sky-500 */
            color: #0284c7; /* sky-600 */
            font-weight: 600;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .code-block {
            background-color: #1e293b; /* slate-800 */
            color: #e2e8f0; /* slate-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
        }
        .accordion-header {
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .case-study-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .case-study-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        /* Diagram styles */
        .diagram-container {
            display: flex;
            align-items: center;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .diagram-element {
            cursor: pointer;
            border: 2px solid #94a3b8; /* slate-400 */
            border-radius: 0.5rem;
            padding: 0.75rem 1.25rem;
            text-align: center;
            transition: all 0.3s ease;
            background-color: white;
            position: relative;
        }
        .diagram-element.active, .diagram-element:hover {
            border-color: #0ea5e9; /* sky-500 */
            background-color: #f0f9ff; /* sky-50 */
            color: #0284c7; /* sky-600 */
        }
        .arrow {
            position: relative;
            flex-grow: 1;
            height: 2px;
            background-color: #64748b; /* slate-500 */
            min-width: 50px;
        }
        .arrow::after {
            content: '';
            position: absolute;
            right: -1px;
            top: -4px;
            width: 0;
            height: 0;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            border-left: 10px solid #64748b; /* slate-500 */
        }
        /* Simulator styles */
        .message {
            transition: all 0.5s ease;
        }
        .queue-box {
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body class="antialiased">
<div class="min-h-screen">
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">Ph√¢n T√≠ch K·ªπ Thu·∫≠t To√†n Di·ªán: RabbitMQ üêá</h1>
            <p class="text-slate-500 mt-1">M·ªôt ·ª©ng d·ª•ng t∆∞∆°ng t√°c ƒë·ªÉ kh√°m ph√° th·∫ø gi·ªõi Message Brokering.</p>
        </div>
        <nav class="bg-slate-100">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-center sm:justify-start space-x-4 sm:space-x-8 overflow-x-auto py-2">
                    <a href="#concept" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">üßê T·ªïng quan</a>
                    <a href="#components" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">üèóÔ∏è Th√†nh ph·∫ßn C·ªët l√µi</a>
                    <a href="#implementation" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">‚òï Tri·ªÉn khai</a>
                    <a href="#best-practices" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">‚ú® Best Practices</a>
                    <a href="#case-studies" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">üè¢ Case Study</a>
                    <a href="#simulator" class="nav-link py-2 px-1 text-sm sm:text-base whitespace-nowrap">üéÆ Simulator</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Section 1: Concept -->
        <section id="concept" class="content-section space-y-8">
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">RabbitMQ l√† g√¨?</h2>
                <p class="mb-4">RabbitMQ l√† m·ªôt <strong class="text-teal-600">message broker</strong> m√£ ngu·ªìn m·ªü, n·ªïi ti·∫øng v√† ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i. N√≥ ti·∫øp nh·∫≠n, l∆∞u tr·ªØ v√† chuy·ªÉn ti·∫øp c√°c th√¥ng ƒëi·ªáp (messages). B·∫°n c√≥ th·ªÉ h√¨nh dung n√≥ nh∆∞ m·ªôt b∆∞u ƒëi·ªán cho ·ª©ng d·ª•ng c·ªßa b·∫°n: n√≥ nh·∫≠n th∆∞ t·ª´ ng∆∞·ªùi g·ª≠i (producers), ƒë·∫£m b·∫£o ch√∫ng ƒë∆∞·ª£c c·∫•t gi·ªØ an to√†n, v√† sau ƒë√≥ giao ƒë·∫øn ƒë√∫ng ng∆∞·ªùi nh·∫≠n (consumers).</p>
                <p>V·ªÅ m·∫∑t k·ªπ thu·∫≠t, n√≥ thu·ªôc danh m·ª•c ph·∫ßn m·ªÅm <strong class="text-teal-600">Message-Oriented Middleware (MOM)</strong>. RabbitMQ ƒë∆∞·ª£c ph√°t tri·ªÉn ban ƒë·∫ßu b·ªüi Rabbit Technologies Ltd., sau ƒë√≥ ƒë∆∞·ª£c mua l·∫°i b·ªüi SpringSource (m·ªôt b·ªô ph·∫≠n c·ªßa VMware). N√≥ ƒë∆∞·ª£c vi·∫øt b·∫±ng ng√¥n ng·ªØ Erlang, v·ªën ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ x√¢y d·ª±ng c√°c h·ªá th·ªëng c√≥ t√≠nh s·∫µn s√†ng cao v√† kh·∫£ nƒÉng ch·ªãu l·ªói t·ªët.</p>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">B√†i to√°n ƒë∆∞·ª£c gi·∫£i quy·∫øt</h2>
                <p class="mb-4">RabbitMQ gi√∫p t√°ch r·ªùi (decouple) c√°c th√†nh ph·∫ßn trong m·ªôt h·ªá th·ªëng ph·∫ßn m·ªÅm, cho ph√©p ch√∫ng giao ti·∫øp m·ªôt c√°ch b·∫•t ƒë·ªìng b·ªô v√† hi·ªáu qu·∫£. D∆∞·ªõi ƒë√¢y l√† ki·∫øn tr√∫c so s√°nh:</p>
                <div class="grid md:grid-cols-2 gap-8 mt-6">
                    <div>
                        <h3 class="font-semibold text-lg text-center mb-2 text-red-600">Tr∆∞·ªõc khi c√≥ RabbitMQ (Coupled)</h3>
                        <div class="border-2 border-red-200 bg-red-50 p-4 rounded-lg text-center">
                            <div class="font-bold bg-red-200 p-2 rounded">D·ªãch v·ª• A (VD: T·∫°o ƒë∆°n h√†ng)</div>
                            <div class="my-2 text-2xl">‚¨áÔ∏è</div>
                            <div class="font-mono text-sm text-red-700">G·ªçi tr·ª±c ti·∫øp API</div>
                            <div class="my-2 text-2xl">‚¨áÔ∏è</div>
                            <div class="font-bold bg-red-200 p-2 rounded">D·ªãch v·ª• B (VD: G·ª≠i Email)</div>
                            <p class="text-xs mt-3 text-red-500">N·∫øu D·ªãch v·ª• B l·ªói, D·ªãch v·ª• A c≈©ng b·ªã ·∫£nh h∆∞·ªüng. Ph·∫£i ch·ªù D·ªãch v·ª• B x·ª≠ l√Ω xong.</p>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg text-center mb-2 text-green-600">Sau khi c√≥ RabbitMQ (Decoupled)</h3>
                        <div class="border-2 border-green-200 bg-green-50 p-4 rounded-lg text-center">
                            <div class="flex justify-around items-center">
                                <div class="font-bold bg-green-200 p-2 rounded">D·ªãch v·ª• A</div>
                                <div class="font-bold bg-green-200 p-2 rounded">D·ªãch v·ª• B</div>
                            </div>
                            <div class="my-2 text-2xl">‚ÜòÔ∏è ‚ÜóÔ∏è</div>
                            <div class="font-bold bg-teal-200 p-3 rounded-full my-2 inline-block">üêá RabbitMQ</div>
                            <div class="my-2 text-2xl">‚ÜôÔ∏è ‚ÜñÔ∏è</div>
                            <div class="flex justify-around items-center">
                                <div class="font-bold bg-green-200 p-2 rounded">D·ªãch v·ª• C</div>
                                <div class="font-bold bg-green-200 p-2 rounded">D·ªãch v·ª• D</div>
                            </div>
                            <p class="text-xs mt-3 text-green-500">C√°c d·ªãch v·ª• giao ti·∫øp gi√°n ti·∫øp, kh√¥ng ph·ª• thu·ªôc v√†o nhau. H·ªá th·ªëng linh ho·∫°t v√† b·ªÅn b·ªâ h∆°n.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">Giao th·ª©c AMQP 0-9-1</h2>
                <p>RabbitMQ ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n <strong class="text-teal-600">Advanced Message Queuing Protocol (AMQP)</strong>, phi√™n b·∫£n 0-9-1. ƒê√¢y l√† m·ªôt giao th·ª©c chu·∫©n m·ªü cho vi·ªác truy·ªÅn tin nh·∫Øn. Vi·ªác tu√¢n th·ªß m·ªôt ti√™u chu·∫©n mang l·∫°i nhi·ªÅu l·ª£i √≠ch:</p>
                <ul class="list-disc list-inside space-y-2 mt-4 text-slate-600">
                    <li><strong>T√≠nh t∆∞∆°ng t√°c (Interoperability):</strong> C√°c ·ª©ng d·ª•ng ƒë∆∞·ª£c vi·∫øt b·∫±ng c√°c ng√¥n ng·ªØ kh√°c nhau, tr√™n c√°c n·ªÅn t·∫£ng kh√°c nhau c√≥ th·ªÉ giao ti·∫øp v·ªõi nhau mi·ªÖn l√† ch√∫ng c√πng tu√¢n th·ªß giao th·ª©c AMQP.</li>
                    <li><strong>ƒê·ªô tin c·∫≠y:</strong> AMQP ƒë·ªãnh nghƒ©a r√µ r√†ng c√°c c∆° ch·∫ø ƒë·∫£m b·∫£o vi·ªác g·ª≠i v√† nh·∫≠n tin nh·∫Øn, nh∆∞ x√°c nh·∫≠n (acknowledgements), ƒë·ªô b·ªÅn (durability), v√† c√°c quy t·∫Øc ƒë·ªãnh tuy·∫øn.</li>
                    <li><strong>Linh ho·∫°t:</strong> Giao th·ª©c n√†y ƒë·ªãnh nghƒ©a c√°c th√†nh ph·∫ßn nh∆∞ Exchange, Queue, v√† Binding, t·∫°o ra m·ªôt m√¥ h√¨nh ƒë·ªãnh tuy·∫øn message r·∫•t m·∫°nh m·∫Ω v√† linh ho·∫°t.</li>
                </ul>
            </div>
        </section>

        <!-- Section 2: Core Components -->
        <section id="components" class="content-section space-y-8">
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">Ki·∫øn tr√∫c v√† c√°c th√†nh ph·∫ßn c·ªët l√µi</h2>
                <p class="mb-6 text-slate-600">ƒê√¢y l√† tr√°i tim c·ªßa RabbitMQ. Lu·ªìng ƒëi c·ªßa m·ªôt message b·∫Øt ƒë·∫ßu t·ª´ Producer, ƒëi qua Exchange, ƒë∆∞·ª£c ƒë·ªãnh tuy·∫øn t·ªõi Queue th√¥ng qua Binding, v√† cu·ªëi c√πng ƒë∆∞·ª£c Consumer ti·∫øp nh·∫≠n. H√£y nh·∫•p v√†o t·ª´ng th√†nh ph·∫ßn trong s∆° ƒë·ªì b√™n d∆∞·ªõi ƒë·ªÉ t√¨m hi·ªÉu chi ti·∫øt.</p>

                <div class="diagram-container p-4 bg-slate-50 rounded-lg border border-dashed">
                    <div id="diag-producer" class="diagram-element">üë®‚Äçüíª<br>Producer</div>
                    <div class="arrow"></div>
                    <div id="diag-exchange" class="diagram-element">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg>
                        Exchange
                    </div>
                    <div class="arrow"></div>
                    <div id="diag-queue" class="diagram-element">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" /></svg>
                        Queue
                    </div>
                    <div class="arrow"></div>
                    <div id="diag-consumer" class="diagram-element">üñ•Ô∏è<br>Consumer</div>
                </div>
                <p class="text-center text-sm text-slate-500 mt-2">Binding (li√™n k·∫øt) v√† Routing Key (kh√≥a ƒë·ªãnh tuy·∫øn) l√† c√°c quy t·∫Øc k·∫øt n·ªëi Exchange v√† Queue.</p>

                <div id="component-details" class="mt-6 bg-sky-50 p-6 rounded-lg border border-sky-200 min-h-[200px]">
                    <p class="text-slate-500">Ch·ªçn m·ªôt th√†nh ph·∫ßn tr√™n s∆° ƒë·ªì ƒë·ªÉ xem m√¥ t·∫£ chi ti·∫øt...</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-sky-700 mb-4">Connection & Channel</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-lg">üîó Connection</h4>
                        <p class="text-slate-600">L√† m·ªôt k·∫øt n·ªëi TCP v·∫≠t l√Ω gi·ªØa ·ª©ng d·ª•ng c·ªßa b·∫°n v√† RabbitMQ server. Vi·ªác thi·∫øt l·∫≠p m·ªôt k·∫øt n·ªëi l√† m·ªôt qu√° tr√¨nh t·ªën k√©m t√†i nguy√™n (li√™n quan ƒë·∫øn qu√° tr√¨nh b·∫Øt tay TCP, x√°c th·ª±c, ...).</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg">multiplexed_connection ‚û°Ô∏è Channel</h4>
                        <p class="text-slate-600">L√† m·ªôt k·∫øt n·ªëi logic, ·∫£o b√™n trong m·ªôt Connection. H·∫ßu h·∫øt c√°c ho·∫°t ƒë·ªông li√™n quan ƒë·∫øn message (publishing, subscribing,...) ƒë·ªÅu di·ªÖn ra tr√™n m·ªôt Channel. M·ªôt Connection c√≥ th·ªÉ c√≥ nhi·ªÅu Channel.</p>
                    </div>
                </div>
                <p class="mt-4 p-4 bg-teal \n -50 border-l-4 border-teal-500 rounded-r-lg">
                    <strong>T·∫°i sao n√™n d√πng nhi·ªÅu Channel?</strong> Vi·ªác m·ªü m·ªôt k·∫øt n·ªëi TCP cho m·ªói lu·ªìng (thread) trong ·ª©ng d·ª•ng l√† r·∫•t kh√¥ng hi·ªáu qu·∫£. Thay v√†o ƒë√≥, ta n√™n m·ªü m·ªôt Connection duy nh·∫•t v√† trong ƒë√≥ m·ªü nhi·ªÅu Channel cho m·ªói lu·ªìng. ƒêi·ªÅu n√†y gi√∫p gi·∫£m ƒë√°ng k·ªÉ l∆∞·ª£ng t√†i nguy√™n h·ªá th·ªëng s·ª≠ d·ª•ng.
                </p>
            </div>
        </section>

        <!-- Section 3: Implementation -->
        <section id="implementation" class="content-section space-y-8">
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">Tri·ªÉn khai v·ªõi Java Spring Boot ‚òï</h2>
                <p class="mb-6 text-slate-600">T√≠ch h·ª£p RabbitMQ v√†o m·ªôt ·ª©ng d·ª•ng Spring Boot l√† m·ªôt qu√° tr√¨nh t∆∞∆°ng ƒë·ªëi ƒë∆°n gi·∫£n nh·ªù v√†o s·ª± h·ªó tr·ª£ m·∫°nh m·∫Ω t·ª´ Spring AMQP. D∆∞·ªõi ƒë√¢y l√† c√°c b∆∞·ªõc h∆∞·ªõng d·∫´n c∆° b·∫£n.</p>

                <div class="code-tabs">
                    <div class="border-b border-gray-200">
                        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                            <button class="code-tab-button active" data-target="dep">pom.xml</button>
                            <button class="code-tab-button" data-target="config">application.yml</button>
                            <button class="code-tab-button" data-target="producer">Producer</button>
                            <button class="code-tab-button" data-target="consumer">Consumer</button>
                            <button class="code-tab-button" data-target="declare">Khai b√°o c·∫•u tr√∫c</button>
                        </nav>
                    </div>
                    <div class="mt-6">
                        <div id="tab-dep" class="code-tab-content active">
                            <h3 class="font-semibold mb-2">1. Th√™m Dependency</h3>
                            <pre class="code-block"><code><dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-amqp</artifactId>
</dependency></code></pre>
                        </div>
                        <div id="tab-config" class="code-tab-content">
                            <h3 class="font-semibold mb-2">2. C·∫•u h√¨nh k·∫øt n·ªëi</h3>
                            <pre class="code-block"><code>spring:
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest</code></pre>
                        </div>
                        <div id="tab-producer" class="code-tab-content">
                            <h3 class="font-semibold mb-2">3. G·ª≠i Message (Producer)</h3>
                            <p class="text-sm mb-2">S·ª≠ d·ª•ng <code>RabbitTemplate</code> ƒë·ªÉ g·ª≠i message.</p>
                            <pre class="code-block"><code>@Autowired
private RabbitTemplate rabbitTemplate;

public void sendOrder(Order order) {
    // S·ª≠ d·ª•ng MessageConverter ƒë·ªÉ t·ª± ƒë·ªông chuy·ªÉn ƒë·ªïi object th√†nh JSON
    rabbitTemplate.convertAndSend("order.exchange", "order.routing.key", order);
}</code></pre>
                        </div>
                        <div id="tab-consumer" class="code-tab-content">
                            <h3 class="font-semibold mb-2">4. Nh·∫≠n Message (Consumer)</h3>
                            <p class="text-sm mb-2">S·ª≠ d·ª•ng annotation <code>@RabbitListener</code>.</p>
                            <pre class="code-block"><code>@RabbitListener(queues = "order.queue")
public void receiveOrder(Order order) {
    System.out.println("Received order: " + order.getId());
    // X·ª≠ l√Ω ƒë∆°n h√†ng...
}</code></pre>
                        </div>
                        <div id="tab-declare" class="code-tab-content">
                            <h3 class="font-semibold mb-2">5. Khai b√°o Queues, Exchanges, Bindings</h3>
                            <p class="text-sm mb-2">S·ª≠ d·ª•ng Java Configuration ƒë·ªÉ t·ª± ƒë·ªông t·∫°o c√°c th√†nh ph·∫ßn khi ·ª©ng d·ª•ng kh·ªüi ƒë·ªông.</p>
                            <pre class="code-block"><code>@Configuration
public class RabbitMQConfig {

    @Bean
    public Queue orderQueue() {
        return new Queue("order.queue", true); // true for durable
    }

    @Bean
    public TopicExchange orderExchange() {
        return new TopicExchange("order.exchange");
    }

    @Bean
    public Binding binding(Queue orderQueue, TopicExchange orderExchange) {
        return BindingBuilder.bind(orderQueue).to(orderExchange).with("order.#");
    }

    @Bean // C·∫•u h√¨nh Jackson2JsonMessageConverter
    public MessageConverter jsonMessageConverter() {
        return new Jackson2JsonMessageConverter();
    }

    @Bean
    public AmqpTemplate rabbitTemplate(ConnectionFactory connectionFactory) {
        final RabbitTemplate rabbitTemplate = new RabbitTemplate(connectionFactory);
        rabbitTemplate.setMessageConverter(jsonMessageConverter());
        return rabbitTemplate;
    }
}</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Best Practices -->
        <section id="best-practices" class="content-section space-y-6">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">C√°c Nguy√™n t·∫Øc T·ªët nh·∫•t (Best Practices) ‚ú®</h2>
            <p class="mb-6 text-slate-600">ƒê·ªÉ v·∫≠n h√†nh RabbitMQ hi·ªáu qu·∫£ v√† ƒë√°ng tin c·∫≠y trong m√¥i tr∆∞·ªùng production, vi·ªác tu√¢n th·ªß c√°c nguy√™n t·∫Øc t·ªët nh·∫•t l√† c·ª±c k·ª≥ quan tr·ªçng.</p>

            <div class="accordion-container space-y-2">
                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header flex justify-between items-center p-4">
                        <h3 class="font-semibold text-lg text-slate-800">üõ°Ô∏è ƒê·ªô b·ªÅn (Durability)</h3>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-4 border-t border-gray-200 text-slate-600 space-y-3">
                            <p><strong>M·ª•c ti√™u:</strong> ƒê·∫£m b·∫£o message kh√¥ng b·ªã m·∫•t khi RabbitMQ server b·ªã kh·ªüi ƒë·ªông l·∫°i.</p>
                            <p><strong>- Durable Queues:</strong> Khai b√°o queue v·ªõi thu·ªôc t√≠nh <code>durable = true</code>. Server s·∫Ω l∆∞u th√¥ng tin v·ªÅ queue n√†y xu·ªëng ƒëƒ©a.</p>
                            <p><strong>- Persistent Messages:</strong> Khi g·ª≠i message, thi·∫øt l·∫≠p thu·ªôc t√≠nh delivery mode l√† 2 (persistent). Server s·∫Ω ghi message n√†y v√†o ƒëƒ©a.</p>
                            <p><strong>- Publisher Confirms:</strong> Producer ch·ªù x√°c nh·∫≠n t·ª´ broker r·∫±ng message ƒë√£ ƒë∆∞·ª£c nh·∫≠n v√† x·ª≠ l√Ω an to√†n. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o message kh√¥ng b·ªã m·∫•t tr√™n ƒë∆∞·ªùng truy·ªÅn t·ª´ producer ƒë·∫øn broker.</p>
                            <p><strong>- Consumer Acknowledgements (Ack/Nack):</strong> Consumer ph·∫£i g·ª≠i t√≠n hi·ªáu x√°c nh·∫≠n (ack) cho broker sau khi ƒë√£ x·ª≠ l√Ω xong message. N·∫øu consumer b·ªã l·ªói ho·∫∑c ch·∫øt tr∆∞·ªõc khi g·ª≠i ack, broker s·∫Ω g·ª≠i l·∫°i message ƒë√≥ cho m·ªôt consumer kh√°c.</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header flex justify-between items-center p-4">
                        <h3 class="font-semibold text-lg text-slate-800">‚ö° Hi·ªáu su·∫•t (Performance)</h3>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-4 border-t border-gray-200 text-slate-600 space-y-3">
                            <p><strong>- S·ª≠ d·ª•ng Channels hi·ªáu qu·∫£:</strong> T√°i s·ª≠ d·ª•ng connection v√† t·∫°o channel cho m·ªói thread nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p.</p>
                            <p><strong>- Prefetch Count (QoS):</strong> Thi·∫øt l·∫≠p s·ªë l∆∞·ª£ng message t·ªëi ƒëa m√† consumer c√≥ th·ªÉ nh·∫≠n v√† gi·ªØ trong b·ªô nh·ªõ c√πng m·ªôt l√∫c tr∆∞·ªõc khi g·ª≠i ack. Gi√° tr·ªã n√†y (<code>prefetch count</code>) ngƒÉn consumer b·ªã qu√° t·∫£i v√† gi√∫p c√¢n b·∫±ng t·∫£i gi·ªØa nhi·ªÅu consumer. M·ªôt gi√° tr·ªã nh·ªè (vd: 10-50) th∆∞·ªùng l√† kh·ªüi ƒë·∫ßu t·ªët.</p>
                            <p><strong>- Lazy Queues:</strong> L√† c√°c queue t·ª± ƒë·ªông l∆∞u message xu·ªëng ƒëƒ©a c√†ng s·ªõm c√†ng t·ªët v√† ch·ªâ t·∫£i l√™n RAM khi consumer y√™u c·∫ßu. R·∫•t h·ªØu √≠ch cho c√°c queue r·∫•t d√†i (h√†ng tri·ªáu message) ƒë·ªÉ gi·∫£m thi·ªÉu vi·ªác s·ª≠ d·ª•ng RAM.</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header flex justify-between items-center p-4">
                        <h3 class="font-semibold text-lg text-slate-800">üöë X·ª≠ l√Ω l·ªói (Error Handling)</h3>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-4 border-t border-gray-200 text-slate-600 space-y-3">
                            <p><strong>V·∫•n ƒë·ªÅ:</strong> ƒêi·ªÅu g√¨ x·∫£y ra khi m·ªôt consumer kh√¥ng th·ªÉ x·ª≠ l√Ω m·ªôt message (v√≠ d·ª•: d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá, d·ªãch v·ª• b√™n ngo√†i b·ªã l·ªói)? N·∫øu ch·ªâ g·ª≠i l·∫°i (nack/requeue), n√≥ c√≥ th·ªÉ t·∫°o ra m·ªôt v√≤ng l·∫∑p v√¥ t·∫≠n.</p>
                            <p><strong>- Dead Letter Exchange (DLX):</strong> L√† m·ªôt exchange th√¥ng th∆∞·ªùng. B·∫°n c√≥ th·ªÉ c·∫•u h√¨nh m·ªôt queue ƒë·ªÉ khi m·ªôt message b·ªã t·ª´ ch·ªëi (nack v·ªõi <code>requeue=false</code>) ho·∫∑c h·∫øt h·∫°n (TTL), n√≥ s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông g·ª≠i ƒë·∫øn DLX n√†y. T·ª´ DLX, b·∫°n c√≥ th·ªÉ ƒë·ªãnh tuy·∫øn message l·ªói ƒë·∫øn m·ªôt "dead letter queue" ƒë·∫∑c bi·ªát ƒë·ªÉ ph√¢n t√≠ch, s·ª≠a ch·ªØa ho·∫∑c b·ªè qua sau n√†y. ƒê√¢y l√† c∆° ch·∫ø x·ª≠ l√Ω l·ªói ti√™u chu·∫©n v√† r·∫•t m·∫°nh m·∫Ω.</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header flex justify-between items-center p-4">
                        <h3 class="font-semibold text-lg text-slate-800">üìà Kh·∫£ nƒÉng m·ªü r·ªông & S·∫µn s√†ng cao (Scalability & HA)</h3>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-4 border-t border-gray-200 text-slate-600 space-y-3">
                            <p><strong>- Clustering:</strong> K·∫øt n·ªëi nhi·ªÅu m√°y ch·ªß RabbitMQ (nodes) l·∫°i v·ªõi nhau th√†nh m·ªôt c·ª•m (cluster). C√°c nodes chia s·∫ª th√¥ng tin v·ªÅ users, vhosts, queues, exchanges... gi√∫p tƒÉng kh·∫£ nƒÉng x·ª≠ l√Ω v√† qu·∫£n l√Ω t·∫≠p trung. Tuy nhi√™n, b·∫£n th√¢n queue ch·ªâ t·ªìn t·∫°i tr√™n m·ªôt node duy nh·∫•t trong cluster.</p>
                            <p><strong>- Mirrored Queues:</strong> ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ single point of failure c·ªßa queue trong cluster, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng Mirrored Queues. M·ªôt queue s·∫Ω c√≥ m·ªôt master v√† m·ªôt ho·∫∑c nhi·ªÅu b·∫£n sao (mirrors) tr√™n c√°c nodes kh√°c. N·∫øu node ch·ª©a master b·ªã l·ªói, m·ªôt trong c√°c mirror s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông thƒÉng c·∫•p th√†nh master, ƒë·∫£m b·∫£o queue v·∫´n ho·∫°t ƒë·ªông v√† kh√¥ng m·∫•t d·ªØ li·ªáu (n·∫øu message l√† persistent).</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="accordion-header flex justify-between items-center p-4">
                        <h3 class="font-semibold text-lg text-slate-800">üìä Gi√°m s√°t (Monitoring)</h3>
                        <span class="transform transition-transform duration-300">‚ñº</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-4 border-t border-gray-200 text-slate-600 space-y-3">
                            <p><strong>C√°c ch·ªâ s·ªë quan tr·ªçng c·∫ßn theo d√µi:</strong></p>
                            <ul class="list-disc list-inside space-y-1">
                                <li><strong>Queue Depth:</strong> S·ªë l∆∞·ª£ng message ƒëang ch·ªù trong queue. N·∫øu tƒÉng li√™n t·ª•c, c√≥ th·ªÉ consumer x·ª≠ l√Ω kh√¥ng k·ªãp.</li>
                                <li><strong>Message Rates:</strong> T·ªëc ƒë·ªô message ƒë∆∞·ª£c publish v√† consume.</li>
                                <li><strong>Memory Usage & Disk Space:</strong> M·ª©c s·ª≠ d·ª•ng b·ªô nh·ªõ v√† ·ªï ƒëƒ©a c·ªßa broker.</li>
                                <li><strong>File Descriptors:</strong> S·ªë l∆∞·ª£ng file/socket ƒëang ƒë∆∞·ª£c m·ªü.</li>
                            </ul>
                            <p><strong>C√¥ng c·ª•:</strong></p>
                            <ul class="list-disc list-inside space-y-1">
                                <li><strong>RabbitMQ Management UI:</strong> Giao di·ªán web t√≠ch h·ª£p s·∫µn, cung c·∫•p c√°i nh√¨n t·ªïng quan v·ªÅ tr·∫°ng th√°i c·ªßa broker.</li>
                                <li><strong>Prometheus & Grafana:</strong> M·ªôt b·ªô ƒë√¥i m·∫°nh m·∫Ω ƒë·ªÉ thu th·∫≠p metrics t·ª´ RabbitMQ (th√¥ng qua m·ªôt exporter) v√† tr·ª±c quan h√≥a ch√∫ng tr√™n c√°c dashboard chuy√™n nghi·ªáp.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Case Studies -->
        <section id="case-studies" class="content-section space-y-8">
            <h2 class="text-2xl font-bold text-sky-700 mb-4">Nghi√™n c·ª©u T√¨nh hu·ªëng Th·ª±c t·∫ø üè¢</h2>
            <p class="mb-6 text-slate-600">RabbitMQ ƒë∆∞·ª£c tin d√πng b·ªüi h√†ng ng√†n c√¥ng ty tr√™n to√†n th·∫ø gi·ªõi, t·ª´ startup ƒë·∫øn c√°c t·∫≠p ƒëo√†n l·ªõn. D∆∞·ªõi ƒë√¢y l√† m·ªôt v√†i v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ c√°ch h·ªç t·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa message brokering.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="case-study-card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="font-bold text-xl text-slate-800">N·ªÅn t·∫£ng Th∆∞∆°ng m·∫°i ƒêi·ªán t·ª≠</h3>
                    <p class="text-sm text-slate-500 mb-4">V√≠ d·ª•: Tiki, Lazada</p>
                    <strong class="text-teal-600">Th√°ch th·ª©c:</strong>
                    <p class="text-slate-600 mb-3">Khi ng∆∞·ªùi d√πng ƒë·∫∑t h√†ng, h·ªá th·ªëng c·∫ßn th·ª±c hi·ªán nhi·ªÅu t√°c v·ª•: x√°c nh·∫≠n thanh to√°n, tr·ª´ t·ªìn kho, g·ª≠i email/SMS x√°c nh·∫≠n, t·∫°o phi·∫øu giao h√†ng. Th·ª±c hi·ªán t·∫•t c·∫£ ƒë·ªìng b·ªô s·∫Ω l√†m tƒÉng ƒë·ªô tr·ªÖ v√† d·ªÖ g√¢y l·ªói to√†n h·ªá th·ªëng n·∫øu m·ªôt b∆∞·ªõc th·∫•t b·∫°i.</p>
                    <strong class="text-teal-600">Gi·∫£i ph√°p v·ªõi RabbitMQ:</strong>
                    <p class="text-slate-600 mb-3">Khi ƒë∆°n h√†ng ƒë∆∞·ª£c t·∫°o, d·ªãch v·ª• Order ch·ªâ c·∫ßn g·ª≠i m·ªôt message "order_created" v√†o m·ªôt <strong class="font-semibold">Topic Exchange</strong>. C√°c d·ªãch v·ª• kh√°c (Inventory, Notification, Shipping) s·∫Ω l·∫Øng nghe t·ª´ c√°c queue ƒë∆∞·ª£c binding v·ªõi routing key ph√π h·ª£p (v√≠ d·ª•: <code>order.*.inventory</code>, <code>order.created.email</code>).</p>
                    <strong class="text-teal-600">K·∫øt qu·∫£:</strong>
                    <p class="text-slate-600">Gi·∫£m ƒë·ªô tr·ªÖ khi ƒë·∫∑t h√†ng, tƒÉng kh·∫£ nƒÉng ch·ªãu l·ªói (n·∫øu d·ªãch v·ª• email l·ªói, c√°c d·ªãch v·ª• kh√°c v·∫´n ho·∫°t ƒë·ªông), v√† d·ªÖ d√†ng th√™m c√°c d·ªãch v·ª• m·ªõi (v√≠ d·ª•: d·ªãch v·ª• ph√¢n t√≠ch h√†nh vi) m√† kh√¥ng c·∫ßn thay ƒë·ªïi code c·ªßa d·ªãch v·ª• Order.</p>
                </div>
                <div class="case-study-card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="font-bold text-xl text-slate-800">H·ªá th·ªëng IoT Thu th·∫≠p D·ªØ li·ªáu</h3>
                    <p class="text-sm text-slate-500 mb-4">V√≠ d·ª•: Gi√°m s√°t n√¥ng nghi·ªáp th√¥ng minh</p>
                    <strong class="text-teal-600">Th√°ch th·ª©c:</strong>
                    <p class="text-slate-600 mb-3">H√†ng ng√†n c·∫£m bi·∫øn (nhi·ªát ƒë·ªô, ƒë·ªô ·∫©m, √°nh s√°ng) g·ª≠i d·ªØ li·ªáu v·ªÅ m√°y ch·ªß li√™n t·ª•c. Vi·ªác x·ª≠ l√Ω m·ªôt l∆∞·ª£ng l·ªõn d·ªØ li·ªáu ghi v√†o c∆° s·ªü d·ªØ li·ªáu c√πng l√∫c c√≥ th·ªÉ g√¢y qu√° t·∫£i cho c·∫£ m·∫°ng v√† database.</p>
                    <strong class="text-teal-600">Gi·∫£i ph√°p v·ªõi RabbitMQ:</strong>
                    <p class="text-slate-600 mb-3">C√°c c·∫£m bi·∫øn (producers) g·ª≠i d·ªØ li·ªáu ƒë·∫øn RabbitMQ. D·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c ƒë·ªãnh tuy·∫øn qua <strong class="font-semibold">Topic Exchange</strong> d·ª±a tr√™n lo·∫°i c·∫£m bi·∫øn v√† v·ªã tr√≠ (<code>sensor.temp.zone1</code>). Nhi·ªÅu nh√≥m consumers c√≥ th·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu n√†y: m·ªôt nh√≥m ghi v√†o database, m·ªôt nh√≥m ph√¢n t√≠ch c·∫£nh b√°o t·ª©c th·ªùi, m·ªôt nh√≥m l∆∞u tr·ªØ l√¢u d√†i.</p>
                    <strong class="text-teal-600">K·∫øt qu·∫£:</strong>
                    <p class="text-slate-600">H·ªá th·ªëng c√≥ th·ªÉ ti·∫øp nh·∫≠n l∆∞·ª£ng d·ªØ li·ªáu l·ªõn m√† kh√¥ng b·ªã s·∫≠p. Ho·∫°t ƒë·ªông nh∆∞ m·ªôt b·ªô ƒë·ªám (buffer) hi·ªáu qu·∫£. D·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω song song cho nhi·ªÅu m·ª•c ƒë√≠ch kh√°c nhau, tƒÉng t√≠nh linh ho·∫°t c·ªßa h·ªá th·ªëng.</p>
                </div>
                <div class="case-study-card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="font-bold text-xl text-slate-800">D·ªãch v·ª• T√†i ch√≠nh & Thanh to√°n</h3>
                    <p class="text-sm text-slate-500 mb-4">V√≠ d·ª•: H·ªá th·ªëng x·ª≠ l√Ω giao d·ªãch</p>
                    <strong class="text-teal-600">Th√°ch th·ª©c:</strong>
                    <p class="text-slate-600 mb-3">X·ª≠ l√Ω giao d·ªãch t√†i ch√≠nh ƒë√≤i h·ªèi ƒë·ªô tin c·∫≠y v√† ch√≠nh x√°c tuy·ªát ƒë·ªëi. Kh√¥ng m·ªôt giao d·ªãch n√†o ƒë∆∞·ª£c ph√©p b·ªã m·∫•t. C√°c b∆∞·ªõc x·ª≠ l√Ω c·∫ßn ph·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán theo ƒë√∫ng th·ª© t·ª± v√† c√≥ kh·∫£ nƒÉng ph·ª•c h·ªìi khi c√≥ s·ª± c·ªë.</p>
                    <strong class="text-teal-600">Gi·∫£i ph√°p v·ªõi RabbitMQ:</strong>
                    <p class="text-slate-600 mb-3">S·ª≠ d·ª•ng tri·ªát ƒë·ªÉ c√°c t√≠nh nƒÉng ƒë·∫£m b·∫£o ƒë·ªô tin c·∫≠y: <strong class="font-semibold">Durable Queues</strong>, <strong class="font-semibold">Persistent Messages</strong>, v√† <strong class="font-semibold">Publisher Confirms</strong>. M√¥ h√¨nh <strong class="font-semibold">Clustering</strong> v·ªõi <strong class="font-semibold">Mirrored Queues</strong> ƒë∆∞·ª£c tri·ªÉn khai ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh s·∫µn s√†ng cao (High Availability). M·ªói giao d·ªãch ƒë∆∞·ª£c coi l√† m·ªôt message v√† ƒë∆∞·ª£c x·ª≠ l√Ω tu·∫ßn t·ª±.</p>
                    <strong class="text-teal-600">K·∫øt qu·∫£:</strong>
                    <p class="text-slate-600">ƒê·∫£m b·∫£o kh√¥ng m·∫•t m√°t d·ªØ li·ªáu giao d·ªãch ngay c·∫£ khi m·ªôt node trong cluster b·ªã l·ªói. H·ªá th·ªëng c√≥ kh·∫£ nƒÉng ch·ªãu t·∫£i v√† ph·ª•c h·ªìi t·ªët, ƒë√°p ·ª©ng c√°c y√™u c·∫ßu kh·∫Øt khe c·ªßa ng√†nh t√†i ch√≠nh.</p>
                </div>
            </div>
        </section>

        <!-- Section 6: Simulator -->
        <section id="simulator" class="content-section space-y-8">
            <div class="bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-bold text-sky-700 mb-4">RabbitMQ Simulator üéÆ</h2>
                <p class="mb-6 text-slate-600">Tr·∫£i nghi·ªám m√¥ ph·ªèng c√°ch RabbitMQ ƒë·ªãnh tuy·∫øn c√°c tin nh·∫Øn th√¥ng qua c√°c lo·∫°i Exchange kh√°c nhau. Nh·∫≠p tin nh·∫Øn v√† kh√≥a ƒë·ªãnh tuy·∫øn, ch·ªçn lo·∫°i Exchange, v√† xem c√°ch tin nh·∫Øn ƒë∆∞·ª£c ph√¢n ph·ªëi ƒë·∫øn c√°c h√†ng ƒë·ª£i.</p>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="text-xl font-semibold mb-4 text-slate-800">Producer: G·ª≠i Tin nh·∫Øn</h3>
                    <div class="flex flex-col space-y-4">
                        <input id="messageInput" type="text" placeholder="Nh·∫≠p tin nh·∫Øn (VD: ƒê∆°n h√†ng #123)" class="border p-2 rounded bg-slate-50 focus:ring-2 focus:ring-sky-500">
                        <input id="routingKeyInput" type="text" placeholder="Nh·∫≠p kh√≥a ƒë·ªãnh tuy·∫øn (VD: order.created)" class="border p-2 rounded bg-slate-50 focus:ring-2 focus:ring-sky-500">
                        <select id="exchangeType" class="border p-2 rounded bg-slate-50 focus:ring-2 focus:ring-sky-500">
                            <option value="direct">Direct Exchange</option>
                            <option value="fanout">Fanout Exchange</option>
                            <option value="topic">Topic Exchange</option>
                        </select>
                        <div class="flex space-x-4">
                            <button onclick="sendMessage()" class="bg-sky-500 text-white px-4 py-2 rounded hover:bg-sky-600 transition">G·ª≠i Tin nh·∫Øn</button>
                            <button onclick="resetSimulation()" class="bg-slate-500 text-white px-4 py-2 rounded hover:bg-slate-600 transition">ƒê·∫∑t l·∫°i</button>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-4 mt-6">
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold mb-2 text-slate-800">Queue 1 (order.created)</h3>
                        <div id="queue1" class="queue-box border p-2 rounded bg-slate-50"></div>
                        <p class="mt-2 text-sm text-slate-600">Consumer: X·ª≠ l√Ω order.created</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold mb-2 text-slate-800">Queue 2 (order.processed)</h3>
                        <div id="queue2" class="queue-box border p-2 rounded bg-slate-50"></div>
                        <p class="mt-2 text-sm text-slate-600">Consumer: X·ª≠ l√Ω order.processed</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-semibold mb-2 text-slate-800">Queue 3 (order.*)</h3>
                        <div id="queue3" class="queue-box border p-2 rounded bg-slate-50"></div>
                        <p class="mt-2 text-sm text-slate-600">Consumer: X·ª≠ l√Ω t·∫•t c·∫£ ƒë∆°n h√†ng</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const navLinks = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');

        function setActiveTab(hash) {
            const targetHash = hash || '#concept';

            navLinks.forEach(link => {
                if (link.getAttribute('href') === targetHash) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            contentSections.forEach(section => {
                if ('#' + section.id === targetHash) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
        }

        navLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const targetHash = this.getAttribute('href');
                setActiveTab(targetHash);
                window.location.hash = targetHash;
            });
        });

        // Initial load
        setActiveTab(window.location.hash);

        // Core Components Diagram Interaction
        const diagramElements = document.querySelectorAll('.diagram-element');
        const detailsContainer = document.getElementById('component-details');

        const componentDetails = {
            'diag-producer': {
                title: 'üë®‚Äçüíª Producer (Nh√† s·∫£n xu·∫•t)',
                content: 'L√† ·ª©ng d·ª•ng ho·∫∑c m·ªôt ph·∫ßn c·ªßa ·ª©ng d·ª•ng g·ª≠i message. Producer kh√¥ng g·ª≠i message tr·ª±c ti·∫øp ƒë·∫øn Queue, m√† g·ª≠i ƒë·∫øn m·ªôt Exchange. N√≥ kh√¥ng c·∫ßn bi·∫øt message c·ªßa n√≥ s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi consumer n√†o.'
            },
            'diag-exchange': {
                title: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg> Exchange (B·ªô chuy·ªÉn m·∫°ch)',
                content: `Nh·∫≠n message t·ª´ Producer v√† ch·ªãu tr√°ch nhi·ªám ƒë·ªãnh tuy·∫øn ch√∫ng ƒë·∫øn c√°c Queue. C√≥ 4 lo·∫°i Exchange ch√≠nh:
                    <ul class="list-disc list-inside mt-2 space-y-1">
                        <li><strong>Direct:</strong> G·ª≠i message ƒë·∫øn queue c√≥ Binding Key tr√πng kh·ªõp ho√†n to√†n v·ªõi Routing Key c·ªßa message.</li>
                        <li><strong>Fanout:</strong> G·ª≠i message ƒë·∫øn T·∫§T C·∫¢ c√°c queue ƒë∆∞·ª£c k·∫øt n·ªëi v·ªõi n√≥, b·ªè qua routing key.</li>
                        <li><strong>Topic:</strong> G·ª≠i message ƒë·∫øn c√°c queue c√≥ Binding Key kh·ªõp v·ªõi Routing Key theo m·ªôt m·∫´u (pattern) nh·∫•t ƒë·ªãnh. D√πng wildcard <code>*</code> (kh·ªõp m·ªôt t·ª´) v√† <code>#</code> (kh·ªõp kh√¥ng ho·∫∑c nhi·ªÅu t·ª´).</li>
                        <li><strong>Headers:</strong> ƒê·ªãnh tuy·∫øn d·ª±a tr√™n c√°c thu·ªôc t√≠nh trong header c·ªßa message thay v√¨ routing key. √çt ph·ªï bi·∫øn h∆°n Topic.</li>
                    </ul>`
            },
            'diag-queue': {
                title: '<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" /></svg> Queue (H√†ng ƒë·ª£i)',
                content: `L√† m·ªôt b·ªô ƒë·ªám (buffer) l∆∞u tr·ªØ c√°c message. M·ªôt message s·∫Ω n·∫±m trong Queue cho ƒë·∫øn khi ƒë∆∞·ª£c m·ªôt Consumer x·ª≠ l√Ω. Queue c√≥ c√°c thu·ªôc t√≠nh quan tr·ªçng:
                     <ul class="list-disc list-inside mt-2 space-y-1">
                        <li><strong>Name:</strong> T√™n c·ªßa queue.</li>
                        <li><strong>Durability:</strong> N·∫øu <code>true</code>, queue s·∫Ω t·ªìn t·∫°i sau khi server kh·ªüi ƒë·ªông l·∫°i.</li>
                        <li><strong>Exclusive:</strong> N·∫øu <code>true</code>, queue ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi connection ƒë√£ t·∫°o ra n√≥ v√† s·∫Ω b·ªã x√≥a khi connection ƒë√≥ ƒë√≥ng.</li>
                        <li><strong>Auto-delete:</strong> N·∫øu <code>true</code>, queue s·∫Ω b·ªã x√≥a khi consumer cu·ªëi c√πng h·ªßy ƒëƒÉng k√Ω.</li>
                    </ul>`
            },
            'diag-consumer': {
                title: 'üñ•Ô∏è Consumer (Ng∆∞·ªùi ti√™u th·ª•)',
                content: 'L√† ·ª©ng d·ª•ng ho·∫∑c m·ªôt ph·∫ßn c·ªßa ·ª©ng d·ª•ng nh·∫≠n v√† x·ª≠ l√Ω message. Consumer ƒëƒÉng k√Ω (subscribe) ƒë·ªÉ nh·∫≠n message t·ª´ m·ªôt Queue c·ª• th·ªÉ.'
            }
        };

        diagramElements.forEach(el => {
            el.addEventListener('click', function() {
                diagramElements.forEach(e => e.classList.remove('active'));
                this.classList.add('active');
                const details = componentDetails[this.id];
                detailsContainer.innerHTML = `
                        <h3 class="text-xl font-bold text-sky-800 mb-2">${details.title}</h3>
                        <p class="text-slate-700">${details.content}</p>
                    `;
            });
        });

        // Code Tabs
        const tabButtons = document.querySelectorAll('.code-tab-button');
        const tabContents = document.querySelectorAll('.code-tab-content');
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                tabButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');

                const targetId = this.getAttribute('data-target');
                tabContents.forEach(content => {
                    if(content.id === 'tab-' + targetId) {
                        content.style.display = 'block';
                    } else {
                        content.style.display = 'none';
                    }
                });
            });
            // Style active button
            button.style.cssText = 'padding: 0.5rem 1rem; border-bottom: 2px solid transparent; color: #64748b;';
            if (button.classList.contains('active')) {
                button.style.cssText = 'padding: 0.5rem 1rem; border-bottom: 2px solid #0ea5e9; color: #0284c7; font-weight: 600;';
            }
            button.addEventListener('mouseover', function() { if(!this.classList.contains('active')) this.style.color = '#334155'; });
            button.addEventListener('mouseout', function() { if(!this.classList.contains('active')) this.style.color = '#64748b'; });
        });
        // Initial style for tabs
        document.querySelectorAll('.code-tab-button').forEach(button => {
            button.style.cssText = 'padding: 0.5rem 1rem; border-bottom: 2px solid transparent; color: #64748b; transition: all 0.3s ease;';
            button.addEventListener('click', function() {
                document.querySelectorAll('.code-tab-button').forEach(btn => {
                    btn.classList.remove('active');
                    btn.style.cssText = 'padding: 0.5rem 1rem; border-bottom: 2px solid transparent; color: #64748b; transition: all 0.3s ease;';
                });
                this.classList.add('active');
                this.style.cssText = 'padding: 0.5rem 1rem; border-bottom: 2px solid #0ea5e9; color: #0284c7; font-weight: 600; transition: all 0.3s ease;';
            });
        });
        document.querySelector('.code-tab-button.active').click();

        // Accordion for Best Practices
        const accordionItems = document.querySelectorAll('.accordion-item');
        accordionItems.forEach(item => {
            const header = item.querySelector('.accordion-header');
            const content = item.querySelector('.accordion-content');
            const icon = header.querySelector('span');

            header.addEventListener('click', () => {
                if (content.style.maxHeight) {
                    content.style.maxHeight = null;
                    icon.style.transform = 'rotate(0deg)';
                } else {
                    // Close other open accordions
                    accordionItems.forEach(otherItem => {
                        const otherContent = otherItem.querySelector('.accordion-content');
                        const otherIcon = otherItem.querySelector('.accordion-header span');
                        otherContent.style.maxHeight = null;
                        otherIcon.style.transform = 'rotate(0deg)';
                    });
                    content.style.maxHeight = content.scrollHeight + "px";
                    icon.style.transform = 'rotate(180deg)';
                }
            });
        });

        // Simulator Functionality
        window.sendMessage = function() {
            const message = document.getElementById('messageInput').value;
            const routingKey = document.getElementById('routingKeyInput').value;
            const exchangeType = document.getElementById('exchangeType').value;

            if (!message || !routingKey) {
                alert('Vui l√≤ng nh·∫≠p c·∫£ tin nh·∫Øn v√† kh√≥a ƒë·ªãnh tuy·∫øn!');
                return;
            }

            // Simulate message animation
            const tempDiv = document.createElement('div');
            tempDiv.className = 'message bg-sky-200 p-2 rounded mb-2';
            tempDiv.textContent = `Tin nh·∫Øn: ${message} (Key: ${routingKey})`;
            tempDiv.style.opacity = '0';
            document.body.appendChild(tempDiv);

            setTimeout(() => {
                tempDiv.style.opacity = '1';
                setTimeout(() => {
                    tempDiv.remove();
                    routeMessage(message, routingKey, exchangeType);
                }, 500);
            }, 100);
        };

        window.routeMessage = function(message, routingKey, exchangeType) {
            const queue1 = document.getElementById('queue1');
            const queue2 = document.getElementById('queue2');
            const queue3 = document.getElementById('queue3');

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bg-teal-200 p-2 rounded mb-2';
            messageDiv.textContent = `Tin nh·∫Øn: ${message} (Key: ${routingKey})`;

            if (exchangeType === 'direct') {
                if (routingKey === 'order.created') {
                    queue1.appendChild(messageDiv.cloneNode(true));
                } else if (routingKey === 'order.processed') {
                    queue2.appendChild(messageDiv.cloneNode(true));
                }
            } else if (exchangeType === 'fanout') {
                queue1.appendChild(messageDiv.cloneNode(true));
                queue2.appendChild(messageDiv.cloneNode(true));
                queue3.appendChild(messageDiv.cloneNode(true));
            } else if (exchangeType === 'topic') {
                if (routingKey.startsWith('order.')) {
                    queue3.appendChild(messageDiv.cloneNode(true));
                }
                if (routingKey === 'order.created') {
                    queue1.appendChild(messageDiv.cloneNode(true));
                } else if (routingKey === 'order.processed') {
                    queue2.appendChild(messageDiv.cloneNode(true));
                }
            }
        };

        window.resetSimulation = function() {
            document.getElementById('queue1').innerHTML = '';
            document.getElementById('queue2').innerHTML = '';
            document.getElementById('queue3').innerHTML = '';
            document.getElementById('messageInput').value = '';
            document.getElementById('routingKeyInput').value = '';
        };
    });
</script>
</body>
</html>